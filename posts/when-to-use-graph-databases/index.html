<!doctype html><html lang=en>
<head>
<title>
When (not) to use graph databases ::
AlexPresso — A front, back, left, right developper and cyber-security administrator.
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Introduction After more than three years of using Neo4J (a graph database based on the JVM), I wanted to share the benefits and drawbacks of using such a technology.
What is a Graph Database ? First things first, a graph database is a NoSQL database based (as its name suggests) on the graphs theory. It was created to address the limitations of relational databases by storing complex interconnected data, in a pure conceptual way using nodes and relationships.">
<meta name=keywords content="developper,frontend,backend,tech,IT,cyber security">
<meta name=robots content="noodp">
<link rel=canonical href=https://alexpresso.me/posts/when-to-use-graph-databases/>
<link rel=stylesheet href=https://alexpresso.me/assets/style.css>
<link rel=stylesheet href=https://alexpresso.me/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://alexpresso.me/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://alexpresso.me/img/favicon.png>
<link href=https://alexpresso.me/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://alexpresso.me/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://alexpresso.me/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://alexpresso.me/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://alexpresso.me/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://alexpresso.me/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="When (not) to use graph databases">
<meta name=twitter:description content="Introduction After more than three years of using Neo4J (a graph database based on the JVM), I wanted to share the benefits and drawbacks of using such a technology.
What is a Graph Database ? First things first, a graph database is a NoSQL database based (as its name suggests) on the graphs theory. It was created to address the limitations of relational databases by storing complex interconnected data, in a pure conceptual way using nodes and relationships.">
<meta property="og:title" content="When (not) to use graph databases">
<meta property="og:description" content="Introduction After more than three years of using Neo4J (a graph database based on the JVM), I wanted to share the benefits and drawbacks of using such a technology.
What is a Graph Database ? First things first, a graph database is a NoSQL database based (as its name suggests) on the graphs theory. It was created to address the limitations of relational databases by storing complex interconnected data, in a pure conceptual way using nodes and relationships.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://alexpresso.me/posts/when-to-use-graph-databases/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-09-01T23:56:46+02:00">
<meta property="article:modified_time" content="2021-09-01T23:56:46+02:00"><meta property="og:site_name" content="AlexPresso">
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>./alexpresso.me</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/posts>Blog</a></li>
<li><a href=/posts/index.xml>RSS</a></li>
<li><a href=/tags>Tags</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/posts>Blog</a></li>
<li><a href=/posts/index.xml>RSS</a></li>
<li><a href=/tags>Tags</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post-header style=background-color:#000;background-image:linear-gradient(rgba(0,0,0,.5),rgba(0,0,0,.5)),url(https://wallpaperaccess.com/full/5568.jpg)>
<div class=post-header-content>
<h1 class="post-title post-title-color-fixed">When (not) to use graph databases</h1>
<div class="post-meta post-meta-color-fixed">
<span class=post-date>
01.09.2021
</span>
<span class=post-read-time>— 6 min read</span>
</div>
<span class="post-tags post-tags-color-fixed">
<a href=https://alexpresso.me/tags/databases/>#databases</a>&nbsp;
<a href=https://alexpresso.me/tags/graph/>#graph</a>&nbsp;
<a href=https://alexpresso.me/tags/relational/>#relational</a>&nbsp;
<a href=https://alexpresso.me/tags/sql/>#sql</a>&nbsp;
</span>
</div>
</div>
<div class=post>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#introduction>Introduction</a></li>
<li><a href=#what-is-a-graph-database->What is a Graph Database ?</a>
<ul>
<li><a href=#graph-data-model>Graph Data Model</a></li>
</ul>
</li>
<li><a href=#relational-vs-graph-databases>Relational vs. Graph Databases</a>
<ul>
<li><a href=#retrieving-connected-data>Retrieving connected data</a></li>
<li><a href=#data-constraints-and-schemas>Data constraints and schemas</a></li>
</ul>
</li>
<li><a href=#pros-and-cons>Pros and cons</a></li>
<li><a href=#when-not-to-use-a-graph-database>When (not) to use a graph database</a></li>
</ul>
</nav></aside>
<h2 id=introduction>Introduction</h2>
<p>After more than three years of using <a href=https://neo4j.com/>Neo4J</a> (a graph database based on the <a href=https://en.wikipedia.org/wiki/Java_virtual_machine>JVM</a>),
I wanted to share the benefits and drawbacks of using such a technology.</p>
<h2 id=what-is-a-graph-database->What is a Graph Database ?</h2>
<p>First things first, a graph database is a <a href=https://en.wikipedia.org/wiki/NoSQL>NoSQL</a> database based (as its name suggests) on the <a href=https://en.wikipedia.org/wiki/Graph_theory>graphs theory</a>.
It was created to address the limitations of relational databases by storing complex interconnected data, in a pure conceptual way using nodes and relationships.</p>
<p>The first concepts of network / graph models for storing and reading data were imagined in the late 1960s
but commercial versions only started to appear in the early 2000s. At this point they were mostly used for reseach and web pages indexation because they weren&rsquo;t stable and secure enough.
Then in the late 2000s, <a href=https://en.wikipedia.org/wiki/ACID>ACID</a> (a paradigm used to guarantee data integrity) compliant graph databases such as Neo4J became available.</p>
<p>Nowadays, they&rsquo;re mainly used in social networks, AIs, banking, tracking and research.</p>
<h3 id=graph-data-model>Graph Data Model</h3>
<p>The Graph Data Model is composed of the following components:</p>
<ul>
<li><strong>Nodes</strong> : These are the main entities of a graph, they&rsquo;re composed of properties and labels.</li>
<li><strong>Properties</strong> : key/value pairs stored within entities.</li>
<li><strong>Labels</strong> : Attribute / type used to group similar nodes together.</li>
<li><strong>Relationships</strong> : The connections between nodes, they&rsquo;re composed of a type/name and can hold properties as well.</li>
</ul>
<p><img src=/img/posts/when-to-use-graph-databases/graph_model_example.png alt="Graph model example"></p>
<p>In the above example we have two nodes (Node A and Node B) having the same <code>NodeLabel</code> and a <code>name</code> property, connected by a relationship having the <code>RELATION</code> type.</p>
<p>If we compare the graph data model to the relational one, you can think of Nodes as rows, Properties as columns, Labels as tables (or a <code>group_id</code> column) and Relationships as foreign keys or join tables, if they hold properties.</p>
<p>You need to know that every relational database model is transposable to a graph model. It&rsquo;s also possible to do it the other way (graph to relational) but you&rsquo;re less likely to do it because of the limitations of relational databases, that we will discuss in the next part.</p>
<h2 id=relational-vs-graph-databases>Relational vs. Graph Databases</h2>
<p>Now that you have a bit of an idea about what a graph database is, let&rsquo;s talk about the main differences with a relational database.</p>
<h3 id=retrieving-connected-data>Retrieving connected data</h3>
<p>In relational databases, &ldquo;connection&rdquo; to other entities/rows is done by referring primary keys and foreign key columns, using Joins.
Joins are processed at query time matching primary and foreign keys of all rows of the related tables (loops iterating on every rows of every joined tables).<br>
These operations are really heavy and even if indexes can be used to optimize it, having more and more rows will kill performances in an exponential way.</p>
<p><img src=/img/posts/when-to-use-graph-databases/relational_db_join.png alt="Relational join loop"></p>
<p>In the above relational example, we used the following query to find a player&rsquo;s games list:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>g</span>.id, <span style=color:#66d9ef>g</span>.name <span style=color:#66d9ef>FROM</span> players p
<span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> players_to_games ptg <span style=color:#66d9ef>ON</span> p.id <span style=color:#f92672>=</span> ptg.player_id
<span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> games <span style=color:#66d9ef>g</span> <span style=color:#66d9ef>ON</span> ptg.game_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>g</span>.id
<span style=color:#66d9ef>WHERE</span> p.id <span style=color:#f92672>=</span> <span style=color:#f92672>?</span>
</code></pre></div><p>At first, the database engine iterates over the <code>players</code> rows to find one having <code>id = ?</code>.
Then it iterates over <code>players_to_games</code> (potentially millions of rows) to locate all the rows referencing our player id and iterates again on <code>games</code> (potentially other millions of rows) to locate all rows referencing previous <code>game_id</code>.<br>
Now that it has made <code>millions + millions + millions</code> iterations, it finally returns the 4 games in the player&rsquo;s list.</p>
<p><img src=/img/posts/when-to-use-graph-databases/graph_relations_example.png alt="Graph relations example"></p>
<p>In the above graph version, if we use the following <a href=https://fr.wikipedia.org/wiki/Cypher_(langage)>Cypher</a> query to retrieve our player&rsquo;s games list:</p>
<pre tabindex=0><code class=language-Cypher data-lang=Cypher>MATCH (p:Player)-[:PLAYS]-&gt;(g:Game)
WHERE id(p) = ?
RETURN g
</code></pre><blockquote>
<p>Because of the way data is stored in a graph, our <code>Player</code> node is <strong>literally</strong> connected to other nodes by its relationships edges.</p>
</blockquote>
<p>At first, the database also iterates over all the <code>Player</code> nodes (potentially millions of nodes) to find the one having <code>id = ?</code>.<br>
Then it follows/iterates over direct relationships having the <code>PLAYS</code> type and directly returns their targets, our so called <code>Game</code> nodes.</p>
<p>We could also imagine having millions and millions of relations to iterate over, but the difference with relational DBs is that since they&rsquo;re connected to our <code>Player</code>, 100% of these relations are related to it, the engine would <strong>never</strong> end iterating on unneeded/unrelated data.</p>
<h3 id=data-constraints-and-schemas>Data constraints and schemas</h3>
<p>In a relational database, you must respect some standards.<br>
Each table must have a primary key (if it doesn&rsquo;t, most engines create a hidden one). Every row have (and must have) the same number of columns and the same column order.<br>
A schema holds your tables, columns and constraints configuration so that when you insert/update data, the engine can verify that every row-column values meet the requirements.</p>
<p>There&rsquo;s no schema in a graph database.</p>
<p>Well&mldr; you can set up some indexes and constraints on properties (like unicity and existence) and there&rsquo;s also graph databases allowing the use of pseudo schema-like features (like <a href=https://www.arangodb.com/>ArangoDB</a>), but graphs aren&rsquo;t meant to have one.<br>
Each graph element has (depending on the graph databases) an internal auto-incremented and read-only <code>id</code> field.
Each node and each relationship having the same labels / types can have different (and a different amount of) properties.</p>
<h2 id=pros-and-cons>Pros and cons</h2>
<p>Despite the fact graph databases outrun relational ones in many ways, they at the moment cannot fully replace them in many cases.</p>
<p>The graph databases are faster at retrieving data because they only process the concrete number of relationships a node has and having schema-less data is also a good advantage when it comes to model changes and evolutions.<br>
These databases are also younger and less mature than relational databases. They for now have some issues at handling a large amount of transactions and, for most databases only supports master to slave replication.</p>
<table>
<thead>
<tr>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td>Faster at retrieving interconnected data</td>
<td>Less Mature (lacking some clustering features for now)</td>
</tr>
<tr>
<td>Flexible and agile structure with a schema-less design</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id=when-not-to-use-a-graph-database>When (not) to use a graph database</h2>
<p>The strength of a database can be measured by comparing: data integrity, performances, efficiency and scalability.</p>
<p>The main purpose of a graph database can be roughly summarized to make quicker and simpler query results.
They get particularly usefull and efficient on models where relational databases reach their capacity limits, because they&rsquo;re less influenced by data quantity and complexity.</p>
<p>However, graph databases aren&rsquo;t a perfect solution for every problem. Far from it. Here are some simple questions to help you choose between graph and relational:</p>
<ul>
<li>Does my data structure change really often ?
<ul>
<li>Graph / Schema-less is a good choice</li>
</ul>
</li>
<li>Is my data highly interconnected ?
<ul>
<li>Graph is a good choice</li>
</ul>
</li>
<li>Is retrieving data more important than storing it ?
<ul>
<li>Graph is a good choice</li>
</ul>
</li>
<li>Does an entity need to store large chunks of information ?
<ul>
<li>Relational is a good choice</li>
</ul>
</li>
<li>Do I need to handle a large amount of connections in real-time ?
<ul>
<li>Relational is a good choice</li>
</ul>
</li>
</ul>
<blockquote>
<p>Note that: You can also make benefits of using both of these technologies, like some famous social networks, using relational databases as persistent master data and graph databases as a cache / fast resolution engine, referencing IDs of relational entities.</p>
</blockquote>
</div>
</div>
</div>
<footer class=footer>
</footer>
<script src=https://alexpresso.me/assets/main.js></script>
<script src=https://alexpresso.me/assets/prism.js></script>
</div>
</body>
</html>